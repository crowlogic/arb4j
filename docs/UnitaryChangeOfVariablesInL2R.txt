Characterization of Unitary Change-of-Variables Operators on L²(ℝ)

Definition 1 (label: def:cov-operator)
A change-of-variables operator on L²(ℝ, μ) where μ is Lebesgue measure is a bounded linear operator U: L²(ℝ) → L²(ℝ) of the form
(Uf)(x) = f(T(x)) · w(x)
for some measurable map T: ℝ → ℝ and measurable weight function w: ℝ → ℂ with |w(x)| > 0 almost everywhere.

Theorem 1 (label: thm:main)
Let U be a change-of-variables operator as in Definition ref: def:cov-operator. Then U is unitary if and only if the following conditions hold:
1) T: ℝ → ℝ is a measurable bijection modulo null sets;
2) μ ∘ T⁻¹ ≪ μ and μ ≪ μ ∘ T⁻¹ (mutual absolute continuity);
3) |w(x)|² = d(μ ∘ T)/dμ (x) almost everywhere;
4) w(x) = √(d(μ ∘ T)/dμ (x)) · e^{iθ(x)} for some measurable phase function θ: ℝ → ℝ.
Furthermore, if T is differentiable almost everywhere with T′(x) ≠ 0 a.e., then condition (3) becomes |w(x)|² = |T′(x)|.

Proof.
Necessity: Assume U is unitary. Since U is an isometry, for any f ∈ L²(ℝ),
‖Uf‖₂² = ‖f‖₂².

Compute the left side:
‖Uf‖₂² = ∫_ℝ |f(T(x))|² |w(x)|² dμ(x).

Define the measure ν by dν = |w|² dμ. By the pushforward identity,
∫_ℝ |f(T(x))|² |w(x)|² dμ(x) = ∫_ℝ |f(y)|² d(T_*ν)(y),
where (T_*ν)(A) = ν(T⁻¹(A)) for measurable sets A.

Hence for all f ∈ L²(ℝ),
∫_ℝ |f(y)|² d(T_*ν)(y) = ∫_ℝ |f(y)|² dμ(y),
so T_*ν = μ. Therefore, for any measurable A,
μ(A) = ν(T⁻¹(A)) = ∫_{T⁻¹(A)} |w(x)|² dμ(x).

For U to be surjective (unitary, not merely isometric), T must be invertible modulo null sets, which requires μ ∘ T⁻¹ ≪ μ and μ ≪ μ ∘ T⁻¹.

By the Radon–Nikodym theorem, since μ ∘ T⁻¹ ≪ μ, there exists ρ ≥ 0 with
ρ(y) = d(μ ∘ T⁻¹)/dμ (y).

For any nonnegative measurable g,
∫_ℝ g(T(x)) dμ(x) = ∫_ℝ g(y) ρ(y) dμ(y).

Comparing with the isometry requirement,
∫_ℝ g(T(x)) |w(x)|² dμ(x) = ∫_ℝ g(y) dμ(y)
for all nonnegative g, one obtains
|w(x)|² = ρ(T(x))⁻¹ almost everywhere. By the chain rule for Radon–Nikodym derivatives,
|w(x)|² = d(μ ∘ T)/dμ (x).

The phase freedom in (4) follows because only |w|² is fixed by the isometry condition.

Sufficiency: Assume (1)–(4). Define U as in Definition ref: def:cov-operator with the specified T and w. The computation above shows U is isometric. Since T is bijective modulo null sets and the measure classes are mutually absolutely continuous, the adjoint exists and is given by
(U* g)(x) = g(T⁻¹(x)) · overline{w(T⁻¹(x))} · √(d(μ ∘ T⁻¹)/dμ (x)) · e^{−iθ(T⁻¹(x))}.
A direct computation yields UU* = U*U = I, hence U is unitary.

For the differentiable case, d(μ ∘ T)/dμ (x) = |T′(x)| by the classical change-of-variables theorem, giving |w(x)|² = |T′(x)|.

Lemma 1 (label: lem:monotone)
If T: ℝ → ℝ is a measurable bijection that is differentiable almost everywhere, then T is either almost everywhere monotone increasing or almost everywhere monotone decreasing.

Proof.
As T is a bijection of ℝ, it cannot change monotonicity on any interval where it is continuous without violating injectivity. Since T is differentiable almost everywhere, it is continuous almost everywhere, and the set where T′ exists has full measure. On this set, T′ cannot change sign without violating bijectivity; hence T′(x) ≥ 0 almost everywhere or T′(x) ≤ 0 almost everywhere.
