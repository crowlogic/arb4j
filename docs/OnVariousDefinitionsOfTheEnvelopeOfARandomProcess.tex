\documentclass[12pt]{article}
\usepackage{amsmath,amssymb,amsthm}
\usepackage{enumitem}
\usepackage{geometry}
\usepackage{hyperref}
\geometry{margin=1in}

\title{ON VARIOUS DEFINITIONS OF THE ENVELOPE OF A RANDOM PROCESS}
\author{R. S. Langley \\ College of Aeronautics, Cranfield Institute of Technology, \\ Cranfield, Bedford MK 43 OAL, England}
\date{(Received 9 January 1985, and in revised form 7 May 1985)}

\theoremstyle{plain}
\newtheorem{theorem}{Theorem}[section]
\newtheorem{lemma}[theorem]{Lemma}
\theoremstyle{definition}
\newtheorem{definition}{Definition}[section]
\theoremstyle{remark}
\newtheorem*{remark}{Remark}
\newtheorem{corollary}{Corollary}[section]

\begin{document}

\maketitle

\begin{abstract}
Statistical properties of the envelope definitions of Rice~\cite{rice1954}, Crandall and Mark~\cite{crandall1963} and Dugundji~\cite{dugundji1958} are derived and compared. It is shown that the definitions of Rice~\cite{rice1954} and Dugundji~\cite{dugundji1958} are equivalent, which implies that the envelope of Rice~\cite{rice1954} is independent of the choice of a central frequency. This contradicts results which have appeared in the literature~\cite{lin1967,lin1976} and the reason for this contradiction is explained. The envelopes of Crandall and Mark~\cite{crandall1963} and Dugundji~\cite{dugundji1958} are found to have the same first order probability density function but different crossing rates and mean frequencies.
\end{abstract}

\section{Introduction}
An extremely useful concept in the theory of random vibrations is that of the envelope process $a(t)$ associated with a random process $x(t)$. Physically, if $x(t)$ is reasonably narrow banded, the envelope process is a smooth curve joining the peaks of $x(t)$ as shown in Figure~\ref{fig:envelope}. Associated with the envelope process is a phase process such that $x(t)$ can be represented as a cosine curve having time varying amplitude (governed by the envelope process) and time varying frequency (governed by the phase process).

\begin{figure}[h]
    \centering
    %\includegraphics{envelope_figure_placeholder}
    \caption{The envelope of a random process.}
    \label{fig:envelope}
\end{figure}

There exist a number of definitions for the envelope process, the three most notable of which are those due to Rice~\cite{rice1954}, Crandall and Mark~\cite{crandall1963} and Dugundji~\cite{dugundji1958} (often attributed to Cram√©r and Leadbetter~\cite{cramer1967}). The Rice envelope~\cite{rice1954} is based upon the expansion of the process $x(t)$ about some central frequency $\omega_r$. This is often considered to be the classical definition of the envelope, and among other things it has been used in the past to derive the statistical properties of ocean waves~\cite{longuet-higgins1974} and second order wave forces~\cite{langley1984}. The envelope of Crandall and Mark~\cite{crandall1963} is an ``energy envelope'' and is defined in terms of $x(t)$ and its time derivative $\dot{x}(t)$. This definition of the envelope is used in stochastic averaging techniques, which are used in conjunction with the Fokker-Planck-Kolmogorov equation to determine the statistics of non-linear random vibration~\cite{roberts1976}. The envelope of Dugundji~\cite{dugundji1958} is derived from the random process $x(t)$ and its Hilbert transform $\hat{x}(t)$. This definition has been used in the first passage problem in random vibration, and the original definition has now been extended to include non-stationary random processes~\cite{yang1972,krenk1983}.

In what follows, the similarities and differences between the different envelope definitions are discussed and various statistical properties are derived for each. It is shown that the envelope definitions of Rice~\cite{rice1954} and Dugundji~\cite{dugundji1958} are equivalent, concerning which there appears to be some confusion in the literature. A corollary of this is that the Rice envelope~\cite{rice1954} is completely independent of the choice of the central frequency $\omega_r$, which contradicts results which have appeared elsewhere~\cite{lin1967,lin1976}. The reason for the contradiction is that previously an error has been made in the derivation of the statistics of the Rice envelope~\cite{rice1954}, which is corrected here. Also, it is shown that although the envelope of Crandall and Mark~\cite{crandall1963} has the same density function as the other definitions, the envelope crossing rates and the statistics of the associated phase angle are different.

\section{Envelope Definitions}
\subsection{Envelopes Formed from a Complex Process}
A random process $x(t)$ can be written as the real part of a complex process $z(t)$ having the form
\begin{equation}
    z(t) = x(t) + i y(t),
    \label{eq:complex_process}
\end{equation}
where $y(t)$ is some arbitrary random process. By using~\eqref{eq:complex_process}, $x(t)$ can be expressed as a cosine curve having time varying amplitude and phase, as follows:
\begin{equation}
    x(t) = a(t) \cos \phi(t), \quad a(t) = |z(t)| = \sqrt{x^2 + y^2}, \quad \phi(t) = \tan^{-1}(y/x).
    \label{eq:amp_phase}
\end{equation}
Here, $a(t)$ and $\phi(t)$ are known as the random envelope and phase processes associated with $x(t)$. The random process $y(t)$ must be chosen to give $a(t)$ the required physical meaning, ideally that $a(t)$ is a smooth curve joining the peaks of $x(t)$, as shown in Figure~\ref{fig:envelope}. Suitable choices of $y(t)$ can be determined by considering the case where $x(t)$ is harmonic, say $x(t) = A \cos \omega t$. In this case the required envelope is $A$, which implies that $y(t) = \pm A \sin \omega t$. This result for $y(t)$ can be related functionally to $x(t)$ in two ways, either as the time derivative of $x(t)$, $y = \dot{x}/\omega$, or as the Hilbert transform of $x(t)$, $y = \hat{x}$. The Hilbert transform $\hat{x}(t)$ is defined as~\cite{papoulis1984}
\begin{equation}
    \hat{x}(t) = \frac{1}{\pi} \int_{-\infty}^{\infty} \frac{x(\tau)}{t - \tau} \, d\tau,
    \label{eq:hilbert}
\end{equation}
and it has the property of converting $\cos \omega t$ to $\sin \omega t$ and $\sin \omega t$ to $-\cos \omega t$. Based on this argument, two definitions for the random envelope process are possible, being
\begin{equation}
    a_1(t) = \sqrt{x^2 + \left( \frac{\dot{x}}{\omega_c} \right)^2}, \quad a_2(t) = \sqrt{x^2 + \hat{x}^2}.
    \label{eq:envelope_defs}
\end{equation}

Equation~\eqref{eq:envelope_defs} with $a_1(t)$ is the envelope definition of Crandall and Mark~\cite{crandall1963} while $a_2(t)$ is the envelope suggested by Dugundji~\cite{dugundji1958}. The above approach offers a unified treatment of the two envelope definitions which were originally developed independently. In equation~\eqref{eq:envelope_defs}, $\omega_c$ represents some constant frequency, the best choice of which is yet to be determined. It can be seen that $a_1(t)$ is guaranteed to follow the peaks of $x(t)$ since the envelope and the process coincide at a peak ($\dot{x}=0$). The extent to which $a_2(t)$ follows the peaks of $x(t)$ will depend upon how closely related $\hat{x}(t)$ is to $\dot{x}(t)$. For a stationary Gaussian process, this can be assessed by forming the joint density function $p(\hat{x}, \dot{x})$ and thus the conditional density function $p(\hat{x} | \dot{x}) = p(\hat{x}, \dot{x}) / p(\dot{x})$. It is easily shown that $p(\hat{x} | \dot{x})$ is Gaussian having a mean and variance given by~\cite{nigam1983}
\begin{equation}
    \mathrm{E}[\hat{x} | \dot{x}] = \left( \frac{\sigma_2}{\sigma_1} \right) \rho \dot{x}, \quad \operatorname{Var}[\hat{x} | \dot{x}] = \sigma_2^2 (1 - \rho^2),
    \label{eq:cond_mean_var}
\end{equation}
where $\sigma_2^2 = \mathrm{E}[\hat{x}^2]$, $\sigma_1^2 = \mathrm{E}[\dot{x}^2]$, and $\rho = \mathrm{E}[\hat{x} \dot{x}] / (\sigma_1 \sigma_2)$. It can be shown~\cite{papoulis1984} that $\mathrm{E}[\hat{x}^2] = m_0$, $\mathrm{E}[\dot{x}^2] = m_2$, and $\mathrm{E}[\hat{x} \dot{x}] = -m_1$, where $m_n$ is the $n$th spectral moment of the single-sided spectrum of $x(t)$, $S_{xx}(\omega)$:
\begin{equation}
    m_n = \int_0^{\infty} \omega^n S_{xx}(\omega) \, d\omega.
    \label{eq:spectral_moments}
\end{equation}

Equation~\eqref{eq:cond_mean_var} then yields
\begin{equation}
    \mathrm{E}[\hat{x} | \dot{x}] = -\left( \frac{m_1}{m_2} \right) \dot{x}, \quad \operatorname{Var}[\hat{x} | \dot{x}] = m_0 q^2,
    \label{eq:cond_mean_var2}
\end{equation}
where $q$ is a parameter which measures the extent to which $x(t)$ is narrow banded:
\begin{equation}
    q^2 = 1 - \frac{m_1^2}{m_0 m_2}.
    \label{eq:q_def}
\end{equation}

From~\eqref{eq:cond_mean_var2}, when $\dot{x}=0$ the mean value of $\hat{x}$ is zero and the variance depends upon $q$. For a narrow banded process for which $q$ is small, it can be concluded that $\hat{x}$ will be approximately zero when $\dot{x}=0$, from which~\eqref{eq:envelope_defs} implies that $a_2(t)$ will follow the peaks of $x(t)$. As $x(t)$ becomes more broad banded it can be expected that $a_2(t)$ will bear less relationship to the peaks of $x(t)$.

Concerning the choice of the frequency $\omega_c$ appearing in~\eqref{eq:envelope_defs}, there are two obvious candidates, the mean frequency of $x(t)$ given by $\omega_1 = m_1 / m_0$ and the mean zero crossing frequency given by $\omega_0 = \sqrt{m_2 / m_0}$. By referring to~\eqref{eq:envelope_defs}, it can be seen that $\mathrm{E}[a_1^2(t)] = m_0 + m_2 / \omega_c^2$. For $\omega_c = \omega_0$ this would give $\mathrm{E}[a_1^2(t)] = 2 m_0$, which is in agreement with the case where $x(t)$ is harmonic, in that the average value of the envelope squared ($A^2$) is equal to twice the average value of the process squared ($2 \times \frac{1}{2}A^2$). Another argument for using $\omega_c = \omega_0$ is that the statistics of $a_1(t)$ are considerably more simple than for the case $\omega_c = \omega_1$. For these reasons $\omega_c = \omega_0$ is used here, although it is noted that Nigam~\cite{nigam1983} has used $\omega_c = \omega_1$ for a narrow banded process. A result which follows from using $\omega_c = \omega_0$ is that $a_1(t)$ and $a_2(t)$ have the same mean squared values, which can be proved from~\eqref{eq:envelope_defs}. The statistics of $a_1(t)$ and $a_2(t)$ are discussed in Sections~\ref{sec:dugundji} and~\ref{sec:crandall_mark}, respectively.

\subsection{The Envelope of Rice}
Rice~\cite{rice1954} has presented a definition of an envelope process which is based on the expansion of a stationary random process $x(t)$ about some central or carrier frequency $\omega_r$. Firstly, $x(t)$ is expressed as a Fourier series in the time interval $t: 0 \to T$,
\begin{equation}
    x(t) = \sum_n \left\{ a_n \cos \omega_n t + b_n \sin \omega_n t \right\},
    \label{eq:fourier_series}
\end{equation}
where $\omega_n = 2\pi n / T$. Since $x(t)$ is a random process, each realization of $x(t)$ on this time interval must be different. The coefficients $a_n$ and $b_n$ must therefore be random variables when viewed across a large number of realizations of $x(t)$, or as more commonly stated, they must be random variables in the ensemble sense. If $x(t)$ is Gaussian with zero mean then it can be shown that as $T \to \infty$, $a_n$ and $b_n$ are independent zero mean Gaussian random variables whose mean squared values are related to the spectrum of $x(t)$~\cite{rice1954}. In fact, $\mathrm{E}[a_n^2] = \mathrm{E}[b_n^2] = 2\pi S_{xx}(\omega_n) / T$, where $S_{xx}(\omega)$ is the single-sided spectrum of $x(t)$. If $x(t)$ is non-Gaussian then the statistical distribution of $a_n$ and $b_n$ is much more complicated, although the representation of~\eqref{eq:fourier_series} is still valid. Equation~\eqref{eq:fourier_series} can be re-written as
\begin{equation}
    x(t) = \sum_n \left\{ a_n \cos \left[ (\omega_n - \omega_r)t + \omega_r t \right] + b_n \sin \left[ (\omega_n - \omega_r)t + \omega_r t \right] \right\},
    \label{eq:shifted_fourier}
\end{equation}
where $\omega_r$ is any fixed frequency, usually chosen as a frequency near to the peak of the spectrum $S_{xx}(\omega)$. Rearranging~\eqref{eq:shifted_fourier} gives
\begin{align}
    x(t) &= I_c(t) \cos \omega_r t - I_s(t) \sin \omega_r t, \label{eq:rice_ic_is_a} \\
    I_c(t) &= \sum_n \left\{ a_n \cos [(\omega_n - \omega_r)t] + b_n \sin [(\omega_n - \omega_r)t] \right\}, \label{eq:rice_ic_b} \\
    I_s(t) &= \sum_n \left\{ a_n \sin [(\omega_n - \omega_r)t] - b_n \cos [(\omega_n - \omega_r)t] \right\}. \label{eq:rice_is_c}
\end{align}

Equation~\eqref{eq:rice_ic_is_a} can now be written such that $x(t)$ is represented as a cosine curve having time dependent amplitude and frequency:
\begin{equation}
    x(t) = a(t) \cos [\omega_r t + \theta(t)], \quad a^2(t) = I_c^2(t) + I_s^2(t), \quad \theta(t) = \tan^{-1} \left[ \frac{I_s(t)}{I_c(t)} \right].
    \label{eq:rice_envelope}
\end{equation}
Here, $a(t)$ as given by~\eqref{eq:rice_envelope} is Rice's definition of the envelope of $x(t)$. 

Alternatively, equation~\eqref{eq:fourier_series} can be written in the form
\begin{equation}
    x(t) = \operatorname{Re}\{z(t)\}, \quad z(t) = \sum_n (a_n - i b_n) e^{i \omega_n t}.
    \label{eq:z_process}
\end{equation}
Now it follows from~\eqref{eq:z_process} that
\begin{equation}
    \operatorname{Im}\{z(t)\} = \sum_n \left\{ a_n \sin \omega_n t - b_n \cos \omega_n t \right\} = \hat{x}(t),
    \label{eq:im_z}
\end{equation}
and thus
\begin{equation}
    z(t) = x(t) + i \hat{x}(t).
    \label{eq:z_x_hatx}
\end{equation}
Also, equations~\eqref{eq:shifted_fourier} and~\eqref{eq:rice_ic_is_a} can be written as
\begin{equation}
    x(t) = \operatorname{Re} \left\{ z(t) e^{-i \omega_r t} \right\} = \operatorname{Re} \left\{ [I_c(t) + i I_s(t)] e^{i \omega_r t} \right\},
    \label{eq:rice_rewrite}
\end{equation}
from which it follows that
\begin{equation}
    I_c(t) + i I_s(t) = z(t) e^{-i \omega_r t}.
    \label{eq:ic_is_z}
\end{equation}
Combining~\eqref{eq:rice_envelope},~\eqref{eq:ic_is_z}, and~\eqref{eq:z_x_hatx} then gives
\begin{equation}
    a^2(t) = I_c^2(t) + I_s^2(t) = |z(t) e^{-i \omega_r t}|^2 = x^2(t) + \hat{x}^2(t).
    \label{eq:rice_dugundji_equiv}
\end{equation}
Comparing~\eqref{eq:rice_dugundji_equiv} and~\eqref{eq:envelope_defs} shows that the envelope definitions of Rice~\cite{rice1954} and Dugundji~\cite{dugundji1958} are equivalent, from which it follows that the envelope of Rice must be independent of $\omega_r$.

\section{The Statistics of the Envelope of Rice}
\label{sec:rice}
In this section, an expression is derived for the joint probability density function (jpdf) $p(a, \dot{a}, \theta, \dot{\theta})$ for the case when $x(t)$ is Gaussian with zero mean, where $a$ and $\theta$ are defined by~\eqref{eq:rice_envelope}. The method used is to start with an expression for $p(I_c, I_s, \dot{I}_c, \dot{I}_s) = p(\mathbf{I})$ and to transform to the variables $(a, \dot{a}, \theta, \dot{\theta})$. From~\eqref{eq:rice_ic_b} and~\eqref{eq:rice_is_c}, it can be concluded that if $a_n$ and $b_n$ are zero mean Gaussian random variables then $\mathbf{I}$ is a zero mean Gaussian vector process with jpdf
\begin{equation}
    p(\mathbf{I}) = \frac{1}{4\pi^2 |S|^{1/2}} \exp \left\{ -\frac{1}{2} \mathbf{I}^T S^{-1} \mathbf{I} \right\},
    \label{eq:jpdf_I}
\end{equation}
where $S$ is a $4 \times 4$ correlation matrix given by $S = \mathrm{E}[\mathbf{I} \mathbf{I}^T]$. This matrix can be found by noting from~\eqref{eq:ic_is_z} and~\eqref{eq:z_x_hatx} that
\begin{align}
    I_c(t) &= x(t) \cos \omega_r t + \hat{x}(t) \sin \omega_r t, \label{eq:ic_x_hatx} \\
    I_s(t) &= -x(t) \sin \omega_r t + \hat{x}(t) \cos \omega_r t. \label{eq:is_x_hatx}
\end{align}
Further, Papoulis~\cite{papoulis1984} has shown that $\mathrm{E}[x^2] = \mathrm{E}[\hat{x}^2] = m_0$, $\mathrm{E}[x \hat{x}] = 0$, $\mathrm{E}[x \dot{x}] = -m_1$, and $\mathrm{E}[\dot{x}^2] = \mathrm{E}[\hat{x}^2] = m_2$. Using these results in~\eqref{eq:ic_x_hatx}--\eqref{eq:is_x_hatx} and their time derivatives leads to
\begin{equation}
    S = \begin{pmatrix}
        m_0 & 0 & 0 & M_2 \\
        0 & m_0 & -M_2 & 0 \\
        0 & -M_2 & M_1 & 0 \\
        M_2 & 0 & 0 & M_1
    \end{pmatrix},
    \label{eq:rice_S_matrix}
\end{equation}
where $M_2 = m_1 - \omega_r m_0$ and $M_1 = m_2 - 2\omega_r m_1 + \omega_r^2 m_0$.

The transformation of variables is performed as follows~\cite{nigam1983}:
\begin{equation}
    p(a, \dot{a}, \theta, \dot{\theta}) = \left| \det \left[ \frac{\partial (I_c, I_s, \dot{I}_c, \dot{I}_s)}{\partial (a, \dot{a}, \theta, \dot{\theta})} \right] \right| p(\mathbf{I}) = |J| p(\mathbf{I}),
    \label{eq:jacobian}
\end{equation}
where the partial derivatives involved in the above determinant can be found by noting from~\eqref{eq:rice_envelope} that $I_c(t) = a(t) \cos \theta(t)$ and $I_s(t) = a(t) \sin \theta(t)$. After some algebra it is found that $|J| = a^2$. The expression for $p(\mathbf{I})$ can be simplified by noting from~\eqref{eq:rice_S_matrix} that the variables $(I_c, \dot{I}_s)$ are uncorrelated from $(I_s, \dot{I}_c)$ which means that $p(\mathbf{I}) = p(I_c, \dot{I}_s) p(I_s, \dot{I}_c)$. This avoids inverting the matrix $S$ to evaluate $p(\mathbf{I})$. The final result is then given by~\eqref{eq:jacobian} with $\mathbf{I}$ written in terms of $(a, \dot{a}, \theta, \dot{\theta})$. Performing the necessary algebra gives
\begin{equation}
    p(a, \dot{a}, \theta, \dot{\theta}) = \frac{a^2}{4\pi^2 m_0 m_2 q^2} \exp \left\{ -\frac{1}{2} \left[ \frac{a^2}{m_0} + \frac{1}{q^2 m_2} \left( \dot{a}^2 + a^2 \left( \dot{\theta} - \frac{m_1}{m_0} + \omega_r \right)^2 \right) \right] \right\},
    \label{eq:rice_joint_pdf}
\end{equation}
where $q$ is the spectral parameter given by~\eqref{eq:q_def}. Integrating over $\theta$ and $\dot{\theta}$ gives
\begin{equation}
    p(a, \dot{a}) = \frac{a}{\sqrt{2\pi m_2} q m_0} \exp \left\{ -\frac{1}{2} \left[ \frac{a^2}{m_0} + \frac{\dot{a}^2}{q^2 m_2} \right] \right\},
    \label{eq:rice_pa_pda}
\end{equation}
a result which is independent of $\omega_r$. Integrating~\eqref{eq:rice_joint_pdf} over $a$ and $\dot{a}$ gives
\begin{equation}
    p(\theta, \dot{\theta}) = \frac{1}{4\pi q m_0 \sqrt{m_2}} \left\{ \frac{1}{m_0} + \frac{1}{q^2 m_2} \left[ \dot{\theta} - \frac{m_1}{m_0} + \omega_r \right]^2 \right\}^{-3/2}.
    \label{eq:rice_ptheta_pdt}
\end{equation}
Integrating over $\dot{\theta}$ shows that $\theta$ has a uniform distribution $p(\theta) = 1/(2\pi)$ valid on a range of $2\pi$. Integrating~\eqref{eq:rice_ptheta_pdt} over $\theta$ gives $p(\dot{\theta})$ as $2\pi$ times the right-hand side of this equation, from which it can be shown that $\dot{\theta}$ has a mean value of $(m_1/m_0) - \omega_r$. Thus the phase process $\theta(t)$ introduced in~\eqref{eq:rice_envelope} is not independent of the central frequency $\omega_r$. However, if $x(t)$ is written as
\begin{equation}
    x(t) = a(t) \cos \psi(t)
    \label{eq:psi_def}
\end{equation}
where $\psi(t) = \omega_r t + \theta(t)$, then it follows that $\psi$ has a mean value of $m_1 / m_0$ and a distribution given by
\begin{equation}
    p(\dot{\psi}) = \frac{1}{2 q m_0 \sqrt{m_2}} \left\{ \frac{1}{m_0} + \frac{1}{q^2 m_2} [\dot{\psi} - m_1/m_0]^2 \right\}^{-3/2},
    \label{eq:psi_pdf}
\end{equation}
and is thus independent of $\omega_r$. $\dot{\psi}$ can be regarded physically as the ``instantaneous'' frequency of the random process $x(t)$. In conclusion, the description of $x(t)$ given by Rice~\cite{rice1954} as~\eqref{eq:rice_envelope}, or equivalently~\eqref{eq:psi_def}, is completely independent of the choice of central frequency $\omega_r$. Although the cosine term in~\eqref{eq:rice_envelope} contains a term $\omega_r t$, this is adjusted for by the fact that $\dot{\theta}$ has a mean value of $(m_1/m_0) - \omega_r$. The true ``carrier frequency'' of the Rice envelope is then always $\omega_1 = m_1 / m_0$.

\section{The Statistics of the Envelope of Dugundji}
\label{sec:dugundji}
If $x(t)$ is Gaussian with zero mean then $x, \hat{x}, \dot{x}$, and $\hat{x}$ form a Gaussian vector process, $\mathbf{x} = (x, \hat{x}, \dot{x}, \hat{x})^T$, which has a jpdf given by
\begin{equation}
    p(\mathbf{x}) = \frac{1}{4\pi^2 |R|^{1/2}} \exp \left\{ -\frac{1}{2} \mathbf{x}^T R^{-1} \mathbf{x} \right\},
    \label{eq:dugundji_jpdf}
\end{equation}
where the correlation matrix $R = \mathrm{E}[\mathbf{x} \mathbf{x}^T]$ can be shown from Papoulis~\cite{papoulis1984} to be
\begin{equation}
    R = \begin{pmatrix}
        m_0 & 0 & 0 & m_2 \\
        0 & m_0 & -m_2 & 0 \\
        0 & -m_2 & m_1 & 0 \\
        m_2 & 0 & 0 & m_1
    \end{pmatrix}.
    \label{eq:dugundji_R}
\end{equation}
The jpdf $p(a, \dot{a}, \phi, \dot{\phi})$, where $a(t)$ and $\phi(t)$ are the random envelope and phase processes which were introduced in~\eqref{eq:amp_phase} (with $y(t) = \hat{x}(t)$), can be found from the following transformation:
\begin{equation}
    p(a, \dot{a}, \phi, \dot{\phi}) = \left| \det \left[ \frac{\partial (x, \hat{x}, \dot{x}, \hat{x})}{\partial (a, \dot{a}, \phi, \dot{\phi})} \right] \right| p(\mathbf{x}) = |J| p(\mathbf{x}).
    \label{eq:dugundji_jacobian}
\end{equation}
Upon using $x(t) = a(t) \cos \phi(t)$ and $\hat{x}(t) = a(t) \sin \phi(t)$ to evaluate the partial derivatives appearing in the above determinant, it can be shown that $|J| = a^2$. Noting that $p(\mathbf{x}) = p(x, \hat{x}) p(\dot{x}, \hat{x})$ and performing the necessary algebra gives
\begin{equation}
    p(a, \dot{a}, \phi, \dot{\phi}) = \frac{a^2}{4\pi^2 m_0 m_2 q^2} \exp \left\{ -\frac{1}{2} \left[ \frac{a^2}{m_0} + \frac{1}{q^2 m_2} \left( \dot{a}^2 + a^2 \left[ \dot{\phi} - \frac{m_1}{m_0} \right]^2 \right) \right] \right\}.
    \label{eq:dugundji_pdf}
\end{equation}
Integrating~\eqref{eq:dugundji_pdf} over $\phi$ and $\dot{\phi}$ gives an identical result for $p(a, \dot{a})$ to that given by~\eqref{eq:rice_pa_pda}. Integrating~\eqref{eq:dugundji_pdf} over $a, \dot{a}$, and $\phi$ gives $p(\dot{\phi})$ to be the same as $p(\dot{\psi})$ of~\eqref{eq:psi_pdf}, demonstrating again the equivalence of the envelopes of Dugundji and Rice.

From~\eqref{eq:rice_pa_pda} the mean rate at which the envelope crosses a level $a$ with positive slope can be calculated as~\cite{lin1967}
\begin{equation}
    \nu_a^+ = \int_0^\infty \dot{a} \, p(a, \dot{a}) \, d\dot{a} = \frac{1}{\sqrt{2\pi}} \sqrt{\frac{m_2}{m_0}} q \left( \frac{a}{\sqrt{m_0}} \right) \exp \left[ -\frac{1}{2} \left( \frac{a^2}{m_0} \right) \right].
    \label{eq:envelope_crossing}
\end{equation}
which can be shown to have a maximum when $a = \sqrt{m_0}$, given by
\begin{equation}
    (\nu_a^\dagger)_{\max} = \frac{1}{\sqrt{2\pi}} \sqrt{\frac{m_2}{m_0}} q e^{-1/2}.
    \label{eq:nu_a_max}
\end{equation}
Integrating~\eqref{eq:rice_pa_pda} over $\dot{a}$ shows that $a(t)$ has a Rayleigh distribution with mean value $\sqrt{\pi m_0 / 2}$. From~\eqref{eq:envelope_crossing} it follows that the envelope crossing rate is a maximum at a level different from the mean, which implies that the envelope process itself is by nature broad banded. This agrees with results given by Rice~\cite{rice1954} who calculated the peak distribution of the envelope for a special case and found that a significant number of peaks occur below the mean value of the envelope. It can also be noted that~\eqref{eq:envelope_crossing} agrees with an asymptotic result for large $a$ given by Rice~\cite{rice1954} for the mean rate at which peaks occur above the level $a$. The rate at which the random process $x(t)$ crosses a level $x$ is known to be
\begin{equation}
    \nu_x^+ = \int_0^\infty \dot{x} p(x, \dot{x}) d\dot{x} = \frac{1}{2\pi} \sqrt{\frac{m_2}{m_0}} \exp \left[ -\frac{1}{2} \left( \frac{x^2}{m_0} \right) \right],
    \label{eq:process_crossing}
\end{equation}
which has a maximum when $x=0$, giving $(\nu_x^+)_{\max} = (1/2\pi) \sqrt{m_2 / m_0}$. A measure of the rate at which the envelope varies as compared to the process $x(t)$ is then
\begin{equation}
    \frac{(\nu_a^+)_{\max}}{(\nu_x^+)_{\max}} = \sqrt{2\pi} q e^{-1/2} \simeq 1.52 q.
    \label{eq:envelope_vs_process}
\end{equation}
It follows that the envelope process will be slowly varying for narrow banded processes for which $q$ is small. Given a value of $q$,~\eqref{eq:envelope_vs_process} can be used to give a rough estimate of the applicability of the concept of a ``slowly varying envelope'' to a particular random process.

\section{The Statistics of the Envelope of Crandall and Mark}
\label{sec:crandall_mark}
From~\eqref{eq:amp_phase}, the following relations hold for the envelope definition of Crandall and Mark~\cite{crandall1963} ($y = \dot{x}/\omega_0$):
\begin{equation}
    x(t) = a(t) \cos \phi(t), \quad \frac{\dot{x}(t)}{\omega_0} = a(t) \sin \phi(t).
    \label{eq:crandall_mark_amp_phase}
\end{equation}
Differentiating these two equations gives
\begin{align}
    \dot{x} &= \dot{a} \cos \phi - a \dot{\phi} \sin \phi, \label{eq:crandall_mark_dx} \\
    \frac{\ddot{x}}{\omega_0} &= \dot{a} \sin \phi + a \dot{\phi} \cos \phi. \label{eq:crandall_mark_ddx}
\end{align}
From~\eqref{eq:crandall_mark_amp_phase}--\eqref{eq:crandall_mark_ddx}, it can be seen that, unlike the envelope definition of Dugundji~\cite{dugundji1958}, for this definition of the envelope $a, \dot{a}, \phi$, and $\dot{\phi}$ are not independent variables. In particular, from~\eqref{eq:crandall_mark_dx} and~\eqref{eq:crandall_mark_ddx} it follows that
\begin{equation}
    \dot{\phi} = -\omega_0 + \frac{\dot{a}}{a} \cot \phi.
    \label{eq:crandall_mark_dphi}
\end{equation}
By using~\eqref{eq:crandall_mark_dphi}, equations~\eqref{eq:crandall_mark_amp_phase}--\eqref{eq:crandall_mark_ddx} can now be written as
\begin{equation}
    x = a \cos \phi, \quad \frac{\dot{x}}{\omega_0} = a \sin \phi, \quad \frac{\ddot{x}}{\omega_0} = \dot{a} (\sin \phi + \cot \phi \cos \phi) - a \omega_0 \cos \phi.
    \label{eq:crandall_mark_reduced}
\end{equation}
The statistics of the envelope of Crandall and Mark can now be determined by using~\eqref{eq:crandall_mark_reduced} to transform the jpdf of the variables $\mathbf{x} = (x, \dot{x}/\omega_0, \ddot{x}/\omega_0)^T$ to the new variables $(a, \dot{a}, \phi)$. In the case where $x(t)$ is Gaussian, the variables $(x, \dot{x}/\omega_0, \ddot{x}/\omega_0)$ have a joint Gaussian distribution given by
\begin{equation}
    p(\mathbf{x}) = \frac{1}{(2\pi)^{3/2} |P|^{1/2}} \exp \left\{ -\frac{1}{2} \mathbf{x}^T P^{-1} \mathbf{x} \right\},
    \label{eq:crandall_mark_jpdf}
\end{equation}
where the correlation matrix $P = \mathrm{E}[\mathbf{x} \mathbf{x}^T]$ can be calculated to be
\begin{equation}
    P = \begin{pmatrix}
        m_0 & 0 & -m_2/\omega_0 \\
        0 & m_2/\omega_0^2 & 0 \\
        -m_2/\omega_0 & 0 & m_4/\omega_0^2
    \end{pmatrix}.
    \label{eq:crandall_mark_P}
\end{equation}
As discussed in Section~2, the frequency $\omega_0 = \sqrt{m_2 / m_0}$ is used here. The transformation of variables is performed as follows:
\begin{equation}
    p(a, \dot{a}, \phi) = \left| \det \left[ \frac{\partial (x, \dot{x}/\omega_0, \ddot{x}/\omega_0)}{\partial (a, \dot{a}, \phi)} \right] \right| p(\mathbf{x}) = |J| p(\mathbf{x}).
    \label{eq:crandall_mark_jacobian}
\end{equation}
Upon using~\eqref{eq:crandall_mark_reduced} to calculate the partial derivatives appearing in the above equation, it can be shown that $|J| = a |\csc \phi|$. The remaining algebra can be simplified by noting that $\dot{x}/\omega_0$ is uncorrelated from $x$ and $\ddot{x}/\omega_0$, meaning that $p(\mathbf{x}) = p(\dot{x}/\omega_0) p(x, \ddot{x}/\omega_0)$ and there is no need to invert the matrix $P$. The final result is
\begin{equation}
    p(a, \dot{a}, \phi) = \frac{a |\csc \phi|}{(2\pi)^{3/2} m_0 \sigma \varepsilon} \exp \left\{ -\left[ \frac{a^2}{2m_0} + \frac{\dot{a}^2 \csc^2 \phi}{2 \sigma^2 \varepsilon^2} \right] \right\},
    \label{eq:crandall_mark_pdf}
\end{equation}
where $\sigma^2 = (m_4 m_0) / m_2$ and $\varepsilon$ is a second spectral width parameter given by
\begin{equation}
    \varepsilon^2 = 1 - \frac{m_2^2}{m_0 m_4}.
    \label{eq:epsilon_def}
\end{equation}
Integrating~\eqref{eq:crandall_mark_pdf} over $\dot{a}$ gives
\begin{equation}
    p(a, \phi) = \frac{a}{2\pi m_0} \exp \left\{ -\frac{a^2}{2m_0} \right\},
    \label{eq:crandall_mark_pa_phi}
\end{equation}
from which it can be concluded that $a$ has a Rayleigh distribution with mean value $\sqrt{\pi m_0 / 2}$ and $\phi$ has a uniform distribution valid over a range of $2\pi$. This is in exact agreement with the envelope of Dugundji. The mean rate at which the envelope crosses a level $a$ with positive slope is given by
\begin{equation}
    \nu_a^+ = \int_0^{2\pi} \int_0^\infty \dot{a} p(a, \dot{a}, \phi) d\dot{a} d\phi.
    \label{eq:crandall_mark_crossing}
\end{equation}
By using~\eqref{eq:crandall_mark_pdf} and performing the integration over $\dot{a}$ first,~\eqref{eq:crandall_mark_crossing} can be evaluated to give
\begin{equation}
    \nu_a^+ = \frac{4}{(2\pi)^{3/2}} \sqrt{\frac{m_4}{m_2}} \varepsilon \left( \frac{a}{\sqrt{m_0}} \right) \exp \left\{ -\frac{1}{2} \left( \frac{a^2}{m_0} \right) \right\}.
    \label{eq:crandall_mark_nu_a}
\end{equation}
This equation bears a striking resemblance to~\eqref{eq:envelope_crossing}, with the difference that higher order spectral moments are involved and the parameter $\varepsilon$ has replaced $q$. The ratio between the mean crossing rate of the envelopes of Crandall and Mark~\cite{crandall1963} and Dugundji~\cite{dugundji1958} can be seen to be independent of the level $a$ and given by
\begin{equation}
    \frac{(\nu_a^+)_{C-M}}{(\nu_a^+)_D} = \frac{2}{\pi} \sqrt{\frac{m_4 m_0}{m_2^2}} \frac{\varepsilon}{q} = \frac{2}{\pi} \frac{\varepsilon}{q \sqrt{1 - \varepsilon^2}}.
    \label{eq:crossing_ratio}
\end{equation}
As an example, consider a narrow band random process having a spectrum of width $2\Delta$ centred on a frequency $\omega$. Correct to order $(\Delta/\omega)^2$, the moments of this spectrum are given by $m_0 = 2\Delta$, $m_1 = 2\Delta \omega$, $m_2 = 2\Delta \omega^2 [1 + \frac{1}{3} (\Delta/\omega)^2]$, and $m_4 = 2\Delta \omega^4 [1 + 2(\Delta/\omega)^2]$. Inserting these expressions into~\eqref{eq:q_def} and~\eqref{eq:epsilon_def} gives $\varepsilon^2 = 4/3 (\Delta/\omega)^2$ and $q^2 = 1/3 (\Delta/\omega)^2$, from which it follows that $\varepsilon = 2q$. Equation~\eqref{eq:crossing_ratio} then predicts that the ratio of the two crossing rates is $4/\pi \simeq 1.27$. Thus for this particular type of spectrum the crossing rates of the Crandall and Mark envelope are around $25\%$ higher than those of the Dugundji envelope.

Certain random processes, such as the response of a linear system to white noise, have a theoretically infinite value of $m_4$. In these cases~\eqref{eq:crandall_mark_nu_a} predicts that the envelope crossing rates are infinite. One way of avoiding this result could be to truncate the response spectrum at a frequency which is high enough to give a good estimate for $m_0$ and $m_2$, but which yields a finite value of $m_4$. Another way might be to replace the response spectrum by an ``equivalent'' band limited rectangular spectrum, as indicated by Lin~\cite{lin1967}. It can be noted that, providing $m_0, m_1$, and $m_2$ are finite, no such problem arises with the envelope of Dugundji~\cite{dugundji1958}.

The statistics of $\dot{\phi}$ for the envelope of Crandall and Mark can be determined by firstly transforming $p(a, \dot{a}, \phi)$ to the variables $(a, \dot{\phi}, \phi)$:
\begin{equation}
    p(a, \dot{\phi}, \phi) = \left| \frac{\partial \dot{a}}{\partial \dot{\phi}} \right| p(a, \dot{a}, \phi).
    \label{eq:crandall_mark_pdf_dphi}
\end{equation}
Using~\eqref{eq:crandall_mark_dphi} to evaluate the partial derivative gives the result
\begin{equation}
    p(a, \dot{\phi}, \phi) = \frac{a^2 |\sec \phi|}{(2\pi)^{3/2} m_0 \sigma \varepsilon} \exp \left\{ -\left[ \frac{a^2}{2m_0} + \frac{a^2 (\dot{\phi} + \omega_0)^2 \sec^2 \phi}{2 \sigma^2 \varepsilon^2} \right] \right\}.
    \label{eq:crandall_mark_pdf_dphi2}
\end{equation}
Integrating the above equation over $a$ and $\phi$ gives
\begin{equation}
    p(\dot{\phi}) = \frac{1}{4\pi} \sqrt{\frac{m_2}{m_4}} \frac{1}{\varepsilon} \Phi \left[ \frac{(\dot{\phi} + \omega_0)}{\varepsilon} \sqrt{\frac{m_2}{m_4}} \right], \quad \Phi[m] = \int_0^{2\pi} \frac{|\sec \phi| d\phi}{(1 + m^2 \sec^2 \phi)^{3/2}}.
    \label{eq:crandall_mark_pdf_dphi3}
\end{equation}
It can be seen from the above that the mean value of $\dot{\phi}$ is $-\omega_0$, which means that the envelope of Crandall and Mark has a ``carrier frequency'' of $\omega_0 = \sqrt{m_2 / m_0}$, as opposed to the value $\omega_1 = m_1 / m_0$ of the envelope of Dugundji. Equation~\eqref{eq:crandall_mark_pdf_dphi3} can be integrated to give the cumulative probability function of $\dot{\phi}$ in the form
\begin{align}
    P(\dot{\phi}) &= \int_{-\infty}^{\dot{\phi}} p(\dot{\phi}) d\dot{\phi} = \frac{1}{4\pi} \left\{ \frac{4x}{\sqrt{1 + x^2}} k \left( \frac{1}{\sqrt{1 + x^2}} \right) + 2\pi \right\}, \label{eq:crandall_mark_cdf} \\
    x &= \sqrt{\frac{m_2}{m_4}} \frac{(\dot{\phi} + \omega_0)}{\varepsilon}, \quad k(m) = \int_0^{\pi/2} \frac{d\phi}{\sqrt{1 - m^2 \sin^2 \phi}}, \label{eq:crandall_mark_elliptic}
\end{align}
where $k(m)$ is the complete elliptic integral of the first kind whose values are tabulated in standard mathematical tables~\cite{abramowitz1965}.

\section{Conclusions}
In this paper the statistical properties of a number of different definitions of the envelope and phase processes associated with a random process $x(t)$ have been considered. The main conclusions which can be made are as follows, where unless otherwise stated it is assumed that $x(t)$ is stationary and Gaussian.
\begin{enumerate}[label=(\arabic*)]
    \item The definitions of Rice~\cite{rice1954} and Dugundji~\cite{dugundji1958} are equivalent, a corollary of which is that the Rice envelope is independent of the choice of a central frequency. Although this fact has been reported elsewhere~\cite{dugundji1958} various results have appeared in the literature~\cite{lin1967,lin1976} which contradict this statement. The errors which led to this contradiction have been pointed out and corrected here. The proof of equivalence of the two envelopes rests on algebra alone and does not depend upon $x(t)$ being Gaussian.
    \item The extent to which the envelope of Dugundji~\cite{dugundji1958} follows the peaks of $x(t)$ can be assessed from~\eqref{eq:cond_mean_var2}, which gives the mean and variance of $\hat{x}(t)$ when $\dot{x}(t)$ has a specified value (in particular $\dot{x}=0$).
    \item The envelope definitions of Dugundji~\cite{dugundji1958} and Crandall and Mark~\cite{crandall1963} lead to the same jpdf of the random envelope and phase processes, $p(a, \phi)$.
    \item The mean or carrier frequency of the envelope of Dugundji~\cite{dugundji1958} is $\omega_1 = m_1 / m_0$, while that of the envelope of Crandall and Mark~\cite{crandall1963} is $\omega_0 = \sqrt{m_2 / m_0}$.
    \item The mean crossing rates of the envelopes of Dugundji~\cite{dugundji1958} and Crandall and Mark~\cite{crandall1963} are given by~\eqref{eq:envelope_crossing} and~\eqref{eq:crandall_mark_nu_a} respectively. In general it can be expected that the mean crossing rates of the latter will be the greater of the two. The extent to which it is possible to state that the envelope is ``slowly varying'' can be assessed from~\eqref{eq:envelope_vs_process}, which gives the ratio of the maximum mean crossing rate of the envelope of Dugundji~\cite{dugundji1958} to the zero crossing rate of $x(t)$.
\end{enumerate}

\begin{thebibliography}{99}
\bibitem{rice1954} S. O. Rice, 1954. In \textit{Selected Papers on Noise and Stochastic Processes} (Ed. N. Wax). New York: Dover. Mathematical analysis of random noise.
\bibitem{crandall1963} S. H. Crandall and W. D. Mark, 1963. \textit{Random Vibration in Mechanical Systems}. New York: Academic Press.
\bibitem{dugundji1958} J. Dugundji, 1958. IRE Transactions on Information Theory IT-4, 53--57. Envelopes and pre-envelopes of real wave forms.
\bibitem{lin1967} Y. K. Lin, 1967. \textit{Probabilistic Theory of Structural Dynamics}. London: McGraw-Hill.
\bibitem{lin1976} Y. K. Lin, 1976. \textit{Probabilistic Theory of Structural Dynamics}. New York: Krieger, second edition.
\bibitem{cramer1967} H. Cram√©r and M. R. Leadbetter, 1967. \textit{Stationary and Related Stochastic Processes}. New York: John Wiley.
\bibitem{longuet-higgins1974} M. S. Longuet-Higgins, 1974. Journal of Geophysical Research 80, 2688--2694. On the joint distribution of the periods and amplitudes of sea waves.
\bibitem{langley1984} R. S. Langley, 1984. Applied Ocean Research 6, 182--186. The statistics of second order wave forces.
\bibitem{roberts1976} J. B. Roberts, 1976. Journal of the Engineering Mechanics Division American Society of Civil Engineers 102, 851--866. First passage probability for non-linear oscillators.
\bibitem{yang1972} J. N. Yang, 1972. Journal of Structural Mechanics 1, 231--248. Nonstationary envelope process and first excursion probability.
\bibitem{krenk1983} S. Krenk, H. O. Madsen and P. H. Madsen, 1983. Journal of Engineering Mechanics 109, 263--278. Stationary and transient response envelopes.
\bibitem{papoulis1984} A. Papoulis, 1984. \textit{Probability, Random Variables and Stochastic Processes}. New York: McGraw-Hill, second edition.
\bibitem{nigam1983} N. C. Nigam, 1983. \textit{Introduction to Random Vibrations}. London: MIT Press.
\bibitem{tayfun1984} M. A. Tayfun, 1984. Ocean Engineering 11, 245--264. Nonlinear effects of the distribution of amplitudes of sea waves.
\bibitem{lyon1961} R. H. Lyon, 1961. Journal of the Acoustical Society of America 33, 1395--1403. On the vibration statistics of a randomly excited hard spring oscillator II.
\bibitem{naess1982} A. Naess, 1982. Applied Ocean Research 4, 181--187. Extreme value estimates based on the envelope concept.
\bibitem{abramowitz1965} M. Abramowitz and I. A. Stegun (Eds.), 1965. \textit{Handbook of Mathematical Functions}. New York: Dover.
\end{thebibliography}

\end{document}
